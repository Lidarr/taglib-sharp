version: 2.2.0.{build}
image: Visual Studio 2017

dotnet_csproj:
  patch: true
  file: '**\*.csproj;**\*.props;**\*.fsproj;**\*.xml'
  version: '{version}'
  package_version: '{version}'
  assembly_version: '{version}'
  file_version: '{version}'
  informational_version: '{version}'

build_script:
- cmd: >-
    git submodule update --init --recursive

    msbuild /restore /m /p:Configuration=Release /clp:v=m TaglibSharp.sln /bl /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"

artifacts:
  - path: src\TaglibSharp\bin\Release
    type: zip

deploy:
  provider: NuGet
  api_key:
    secure: oUNK4IL5eChnpm5RiwipJxAY9/qYNiD+8AKi5eMvSeg5ka6eIOZHFNGMEavoqscW
  skip_symbols: false
  artifact: /.*\.nupkg/

pull_requests:
  do_not_increment_build_number: true

skip_branch_with_pr: true
